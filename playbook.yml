---

- hosts: all:!localactions
  become: yes
  roles:
   - water-gkhs-packages
   - water-gkhs-listchanges
   - water-gkhs-update
   - water-gkhs-network
   - water-gkhs-users
   - { role: "ansible.papertrail", tags: papertrail }
   - { role: water-gkhs-web-errors, tags: nginx }

- hosts: archipelago_cenote
  become: yes
  roles:
    - { role: water-gkhs-mysql-backup, tags: mysql }

- hosts: nginx_hosts
  become: yes
  roles:
    - { role: water-gkhs-nginx, tags: nginx }

- hosts: firth
  become: yes
  roles:
    - firth-packages
    - firth-users
    - firth-exim
    - firth-docker
    - plexupdate
    - { role: firth-nginx, tags: nginx }
    - water-gkhs-filebot
    - water-gkhs-flexget
    - b2-backup
    - { role: aws-route53, become: no, connection: local }
    - { role: aws-pdforums , tags: pdforum }
    - { role: elastic.elasticsearch, tags: elastic }

- hosts: caisson
  become: yes
  roles:
    - water-gkhs-nginx
    - caisson-printers
    - caisson-lcd
    - hannseman.homebridge
  vars:
    homebridge_plugins:
     - name: homebridge-tuya-web
     - name: homebridge-dummy
     - name: homebridge-control-chromecast
     - name: homebridge-switchbot
     - name: homebridge-tplink-smarthome

# Non-authenticated tasks
#- hosts: all:!localactions
#  roles:
#   - aquarion-bootstrap
